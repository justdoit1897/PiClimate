

HEX

0 CONSTANT INP
1 CONSTANT OUT
2 CONSTANT ALT5
3 CONSTANT ALT4
4 CONSTANT ALT0
5 CONSTANT ALT1
6 CONSTANT ALT2
7 CONSTANT ALT3

: N_GPIO 
    0 SWAP 
    BEGIN 
        DUP 2 MOD 0 = IF 
            1 RSHIFT SWAP 1+ SWAP 
            ELSE 
        THEN DUP 2 =
    UNTIL 
    DROP 1+ ;

: MODE SWAP LSHIFT ;

: GPIO_LSB N_GPIO 10 MOD 3 * ;

: FSEL_MASK 
    DUP DUP
    2 + >R
    1 + >R
    BILS
    1 R> LSHIFT OR
    1 R> LSHIFT OR ;

: FSEL GPIO_LSB FSEL_MASK ;

( GPIOn N_GPIO )
: GPFSEL
    N_GPIO 10 / 4 * GPFSEL0 + ;

: RED_PINS GPIO23 FSEL GPIO23 OUT MODE GPIO23 GPFSEL

( GPIOn INP/OUT/ETC. -- )
: SETUP_PIN
    OVER DUP 
    FSEL
    -ROT MODE
    ROT GPFSEL ;

